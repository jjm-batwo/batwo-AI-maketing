# 바투 AI 마케팅 SaaS - 개선 로드맵

> **Plan Phase** | 작성일: 2026-02-05
> **기반 분석**: docs/03-analysis/codebase-analysis.md (Match Rate: 90%)

---

## 1. 개요

### 1.1 현재 상태
- **전체 Match Rate**: 90%
- **클린 아키텍처 준수**: 92%
- **기능 완성도**: 87%
- **테스트 커버리지**: 80%

### 1.2 목표
- Match Rate **90% → 95%** 달성
- 모든 핵심 기능 **완성도 95%** 이상
- E2E 테스트 커버리지 **주요 플로우 100%**

### 1.3 범위
분석에서 발견된 모든 개선사항을 우선순위별로 구현

---

## 2. 개선 항목

### 2.1 우선순위 높음 (P0) - 즉시 실행

| ID | 항목 | 현재 상태 | 목표 | 예상 복잡도 |
|----|------|----------|------|:----------:|
| P0-1 | E2E 테스트 커버리지 | 일부 구현 | 핵심 플로우 100% | 중간 |
| P0-2 | 서비스 계층 우회 훅 수정 | 일부 훅 직접 API 호출 | 모든 훅 서비스 계층 경유 | 낮음 |
| P0-3 | 팀 협업 권한 시스템 | 기본 팀/멤버 관리 | 역할 기반 권한 시스템 | 높음 |

### 2.2 우선순위 중간 (P1) - 다음 스프린트

| ID | 항목 | 현재 상태 | 목표 | 예상 복잡도 |
|----|------|----------|------|:----------:|
| P1-1 | A/B 테스트 통계 분석 | 기본 구조 | 통계적 유의성 계산 | 중간 |
| P1-2 | PDF 보고서 템플릿 | 제한적 | 다양한 템플릿 지원 | 중간 |
| P1-3 | Redis 캐싱 레이어 | 없음 | KPI 데이터 캐싱 | 중간 |

### 2.3 우선순위 낮음 (P2) - 백로그

| ID | 항목 | 현재 상태 | 목표 | 예상 복잡도 |
|----|------|----------|------|:----------:|
| P2-1 | 컴포넌트 테스트 | 일부 누락 | 모든 주요 컴포넌트 | 낮음 |
| P2-2 | API 문서화 | 없음 | OpenAPI 스펙 생성 | 낮음 |
| P2-3 | 성능 최적화 | 기본 | 로딩 시간 50% 감소 | 중간 |

---

## 3. 상세 계획

### 3.1 P0-1: E2E 테스트 커버리지

**목표**: 핵심 사용자 플로우 100% 테스트 커버리지

**테스트 시나리오**:

| 플로우 | 현재 | 목표 | 우선순위 |
|--------|:----:|:----:|:--------:|
| 회원가입/로그인 | ⚠️ | ✅ | 1 |
| 온보딩 위저드 | ⚠️ | ✅ | 1 |
| Meta 계정 연결 | ⚠️ | ✅ | 1 |
| 캠페인 CRUD | ⚠️ | ✅ | 2 |
| KPI 대시보드 조회 | ⚠️ | ✅ | 2 |
| AI 카피 생성 | ❌ | ✅ | 3 |
| 결제 플로우 | ❌ | ✅ | 3 |

**구현 파일**:
```
tests/e2e/
├── auth/
│   ├── login.spec.ts
│   ├── signup.spec.ts
│   └── oauth.spec.ts
├── onboarding/
│   ├── wizard.spec.ts
│   └── meta-connect.spec.ts
├── campaigns/
│   ├── create.spec.ts
│   ├── edit.spec.ts
│   └── status-change.spec.ts
├── dashboard/
│   └── kpi.spec.ts
├── ai/
│   └── copy-generation.spec.ts
└── payment/
    ├── subscription.spec.ts
    └── billing.spec.ts
```

**성공 기준**:
- [ ] 모든 핵심 플로우 테스트 통과
- [ ] CI/CD 파이프라인 연동
- [ ] 테스트 실행 시간 < 5분

---

### 3.2 P0-2: 서비스 계층 우회 훅 수정

**목표**: 모든 프레젠테이션 훅이 애플리케이션 서비스 계층을 통해 데이터 접근

**현재 문제**:
일부 훅에서 직접 API 호출 → 클린 아키텍처 위반

**수정 대상 훅**:
```typescript
// 수정 전 (직접 API 호출)
const useSomeData = () => {
  return useQuery({
    queryKey: ['data'],
    queryFn: () => fetch('/api/data').then(r => r.json())
  })
}

// 수정 후 (서비스 계층 경유)
const useSomeData = () => {
  const service = container.get<ISomeService>(DI_TOKENS.SomeService)
  return useQuery({
    queryKey: ['data'],
    queryFn: () => service.getData()
  })
}
```

**영향 범위 분석 필요**:
- `src/presentation/hooks/` 전체 스캔
- 직접 fetch 호출 식별
- 해당 서비스 인터페이스 확인

**성공 기준**:
- [ ] 모든 훅이 DI 컨테이너를 통해 서비스 접근
- [ ] 직접 API 호출 0건
- [ ] 기존 기능 동작 유지 (회귀 테스트)

---

### 3.3 P0-3: 팀 협업 권한 시스템

**목표**: 역할 기반 접근 제어 (RBAC) 구현

**역할 정의**:

| 역할 | 설명 | 권한 |
|------|------|------|
| Owner | 팀 소유자 | 모든 권한 |
| Admin | 관리자 | 멤버 관리, 설정 변경 |
| Editor | 편집자 | 캠페인 CRUD, 보고서 |
| Viewer | 열람자 | 읽기 전용 |

**도메인 모델**:
```
src/domain/
├── entities/
│   ├── Team.ts (기존)
│   ├── TeamMember.ts (기존)
│   └── TeamRole.ts (신규)
├── value-objects/
│   └── Permission.ts (신규)
└── repositories/
    └── ITeamRoleRepository.ts (신규)
```

**권한 체크 포인트**:
- API 라우트 미들웨어
- 유스케이스 실행 전
- UI 컴포넌트 렌더링

**성공 기준**:
- [ ] 4가지 역할 정의 완료
- [ ] 모든 API 엔드포인트 권한 체크
- [ ] UI에서 역할별 기능 표시/숨김

---

### 3.4 P1-1: A/B 테스트 통계 분석

**목표**: 통계적 유의성 기반 A/B 테스트 결과 분석

**기능**:
- 신뢰 구간 계산 (95%)
- 통계적 유의성 판단
- 샘플 크기 권장
- 승자 자동 판정

**구현 위치**:
```
src/domain/value-objects/
└── StatisticalSignificance.ts

src/application/services/
└── ABTestAnalysisService.ts
```

---

### 3.5 P1-2: PDF 보고서 템플릿

**목표**: 다양한 보고서 템플릿 지원

**템플릿 종류**:
- 일간 성과 보고서
- 주간 종합 보고서
- 월간 분석 보고서
- 캠페인별 상세 보고서
- 경영진 요약 보고서

---

### 3.6 P1-3: Redis 캐싱 레이어

**목표**: KPI 데이터 캐싱으로 응답 시간 개선

**캐싱 대상**:
- KPI 대시보드 데이터 (TTL: 5분)
- 캠페인 목록 (TTL: 1분)
- 사용자 할당량 (TTL: 30초)

**구현**:
```
src/infrastructure/cache/
├── RedisCacheService.ts
└── CacheKeys.ts
```

---

## 4. 구현 순서

```
Phase 1: 기반 정비 (Week 1-2)
├── P0-2: 서비스 계층 우회 훅 수정
└── P0-1: E2E 테스트 (인증, 온보딩)

Phase 2: 핵심 기능 (Week 3-4)
├── P0-1: E2E 테스트 (캠페인, 대시보드)
└── P0-3: 팀 협업 권한 시스템 (설계 + 도메인)

Phase 3: 권한 시스템 (Week 5-6)
├── P0-3: 팀 협업 권한 시스템 (구현 + 테스트)
└── P0-1: E2E 테스트 (AI, 결제)

Phase 4: 확장 기능 (Week 7-8)
├── P1-1: A/B 테스트 통계 분석
├── P1-2: PDF 보고서 템플릿
└── P1-3: Redis 캐싱 레이어

Phase 5: 마무리 (Week 9-10)
├── P2-1: 컴포넌트 테스트
├── P2-2: API 문서화
└── 최종 검증 및 배포
```

---

## 5. 위험 요소

| 위험 | 영향 | 완화 방안 |
|------|:----:|----------|
| 권한 시스템 복잡도 | 높음 | 단계적 구현, MVP 먼저 |
| E2E 테스트 불안정 | 중간 | 재시도 로직, 격리된 환경 |
| 기존 기능 회귀 | 높음 | 각 단계별 회귀 테스트 |
| 일정 지연 | 중간 | 버퍼 기간 확보 |

---

## 6. 성공 지표

| 지표 | 현재 | 목표 | 측정 방법 |
|------|:----:|:----:|----------|
| Match Rate | 90% | 95% | Gap Analysis |
| 기능 완성도 | 87% | 95% | 기능별 체크리스트 |
| E2E 커버리지 | 50% | 100% | 핵심 플로우 기준 |
| 테스트 통과율 | - | 100% | CI/CD |
| 빌드 성공률 | - | 100% | CI/CD |

---

## 7. 다음 단계

이 계획이 승인되면:

```bash
# 설계 문서 작성
/pdca design improvement-roadmap

# 또는 개별 기능별로 진행
/pdca design e2e-test-coverage
/pdca design team-permission-system
```

---

*이 계획은 2026-02-05 코드베이스 분석 결과를 기반으로 작성되었습니다.*
