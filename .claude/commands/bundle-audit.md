# /bundle-audit - 번들 최적화 감사

Webpack/Turbopack 번들 최적화 전문가이자 Next.js 퍼포먼스 엔지니어로서, 프로젝트의 초기 로딩 속도(TTI)와 블로킹 시간(TBT) 단축을 위한 코드 분할 및 트리 쉐이킹 전략을 점검합니다.

---

## 분석 절차

### 1단계: 의존성 분석
`package.json`의 dependencies를 분석하여 다음을 확인합니다:
- 번들 크기가 큰 라이브러리 식별 (50KB+ gzipped)
- CJS-only 라이브러리 (트리 쉐이킹 불가) 확인
- 중복 기능 라이브러리 탐지

### 2단계: 동적 임포트(Dynamic Import) 대상 식별
초기 화면(LCP)에 필요 없는 컴포넌트를 찾아 `next/dynamic` 적용을 제안합니다:
- 모달, 드로어, 바텀시트
- 탭 내부 콘텐츠 (기본 탭 제외)
- 스크롤 아래에 있는 차트, 지도, 에디터
- 조건부 렌더링 컴포넌트 (로그인 후에만 표시 등)
- 브라우저 API(`window`, `document`)를 사용하는 라이브러리는 `ssr: false` 옵션 필요 여부 체크

### 3단계: 트리 쉐이킹(Tree Shaking) 점검
잘못된 import 방식을 찾아 수정합니다:
- 라이브러리 전체 불러오기 (예: `import _ from 'lodash'`)
- 아이콘 라이브러리 전체 불러오기 (예: `import * as Icons from 'lucide-react'`)
- barrel export를 통한 불필요한 모듈 포함

### 4단계: 무거운 라이브러리 대체 제안
용량이 큰 라이브러리에 대한 경량 대안을 제시합니다:
- Moment.js → Day.js / date-fns
- Lodash → lodash-es / native JS
- axios → fetch API (Next.js 내장)
- 기타 대형 라이브러리

### 5단계: 번들 사이즈 측정
`npx next build`의 출력에서 페이지별 번들 크기를 분석합니다:
- First Load JS 크기 확인
- Shared chunk 크기 확인
- 200KB 이상 페이지 경고

---

## 출력 형식

```
## 번들 최적화 리포트 (YYYY-MM-DD)

### 요약
- 현재 First Load JS: XXX KB
- 예상 절감: XXX KB (XX%)
- 우선순위 조치: N건

### P0: 즉시 적용 (큰 효과)
| 대상 | 현재 | 제안 | 예상 절감 |
|------|------|------|----------|

### P1: 권장 적용
| 대상 | 현재 | 제안 | 예상 절감 |
|------|------|------|----------|

### P2: 선택 적용
| 대상 | 현재 | 제안 | 예상 절감 |
|------|------|------|----------|

### 동적 임포트 적용 대상
- [ ] 컴포넌트명 (파일 경로) - 사유

### 트리 쉐이킹 수정 대상
- [ ] import 문 수정 (파일 경로)

### 라이브러리 대체 제안
| 현재 | 대안 | 크기 비교 |
|------|------|----------|
```
